### Content

## 네트워크의 기초

네트워크란 노드와 링크가 서로 연결되어 있으며 리소스를 공유하는 집합을 의미한다.

_(여기서 노드란 서버, 라우터, 스위치 등 네트워크 장치를 의미하고, 링크는 유선 또는 무선을 의미한다.)_

### 처리량

처리량은 링크 내에서 성공적으로 전달된 데이터의 양을 말한다.

→ 얼마만큼의 트래픽을 처리했는지를 나타낸다.

_(많은 트래픽을 처리한다 = 많은 처리량을 가진다)_

\*트래픽 : **서버와 클라이언트가 주고받는 데이터의 양\***

처리량의 단위는 bps를 사용한다. 초당 전송 또는 수신되는 비트 수라는 의미이다.

처리량은 트래픽, 네트워크 장치 간의 대역폭, 네트워크 에러, 하드웨어 스펙에 영향을 받는다.

_대역폭 : 주어진 시간 동안 네트워크 연결을 통해 흐를 수 있는 최대 비트 수_

> 트래픽이 많아졌다. = 흐르는 데이터가 많아졌다.
> 처리량이 많아졌다. = 처리되는 트래픽이 많아졌다.

### 지연 시간

지연 시간은 요청이 처리되는 시간을 의미한다.

→ 메시지가 두 장치 사이를 왕복하는 시간

지연 시간은 매체 타입(무선, 유선), 패킷 크기, 라우터의 패킷 처리 시간에 영향을 받는다.

---

## TCP/IP 4계층 모델

인터넷 프로토콜 스위트는 인터넷에서 컴퓨터들이 서로 정보를 주고받는 데 쓰이는 프로토콜의 집합이며, 이를 TCP/IP 4계층 모델로 설명하거나, OSI 7계층 모델로 설명하곤 한다.

_(책 기준으로 TCP/IP 4계층 모델로 진행합니다.)_

![image.png](%E1%84%89%E1%85%AE%E1%84%8B%E1%85%A5%E1%86%B8%20%E1%84%82%E1%85%A2%E1%84%8B%E1%85%AD%E1%86%BC%201641a7d7f2f98028af07fb3c7b8be951/image.png)

이 계층들은 특정 계층이 변경되어도 다른 계층이 영향을 받지 않도록 설계되어 있다.

_(예로 전송계층에서 TCP에서 UDP로 변경해도 인터넷 웹 브라우저를 재설치 불필요)_

---

### 애플리케이션 계층

응용 프로그램이 사용되는 프로토콜 계층으로, 서비스를 실질적으로 사용자에게 제공하는 계층이다.

- FTP
  - 장치와 장치 간의 파일을 전송하는 데 사용되는 표준 통신 프로토콜
- SSH
  - 보안되지 않은 네트워크에서 네트워크 서비스를 안전하게 운영하기 위한 암호화 네트워크 프로토콜
- HTTP
  - WWW을 위한 데이터 통신의 기초, 웹 사이트를 이용하는데 쓰이는 프로토콜
- SMTP
  - 전자 메일 전송을 위한 인터넷 표준 통신 프로토콜
- DNS
  - 도메인 이름과 IP주소를 매핑해주는 서버
    - IP주소가 바뀌어도 사용자들에게 똑같은 도메인 주소로 서비스 가능

---

### 전송 계층

송신자와 수신자를 연결하는 통신 서비스를 제공한다.

→ 연결 지향 데이터 스트림 지원, 신뢰성, 흐름 제어를 제공

→ 애플리케이션과 인터넷 계층 사이의 데이터가 전달될 때 중계 역할을 한다.

### TCP

패킷 사이의 순서를 보장하고, 연결지향 프로토콜을 사용해서 연결을 하여 신뢰성을 구축해서 수신 여부를 확인하며 ‘가상회선 패킷 교환 방식’을 사용한다.

**가상화선 패킷 교환 방식**

각 패킷에는 가상회선 식별자가 포함되며 모든 패킷을 전송하면 가상회선이 해제되고 패킷들은 전송된 순서대로 도착하는 방식

![12.png](%E1%84%89%E1%85%AE%E1%84%8B%E1%85%A5%E1%86%B8%20%E1%84%82%E1%85%A2%E1%84%8B%E1%85%AD%E1%86%BC%201641a7d7f2f98028af07fb3c7b8be951/12.png)

_(정해진 시간에 다량의 데이터를 연속으로 보낼 때 적합하지만, 네트워크 내의 한 노드가 다운되면 그 노드를 지나는 모든 가상회선을 잃는다.)_

**3-way handshake**

TCP는 신뢰성을 확보할 때 3-way handshake 작업을 진행한다.

![image.png](%E1%84%89%E1%85%AE%E1%84%8B%E1%85%A5%E1%86%B8%20%E1%84%82%E1%85%A2%E1%84%8B%E1%85%AD%E1%86%BC%201641a7d7f2f98028af07fb3c7b8be951/image%201.png)

진행 과정

<aside>

\*\*SYN - 연결 요청 플래그

ACK - 응답 플래그

ISN - 초기 네트워크 연결을 할 때 할당된 32비트 고유 시퀀스 번호\*\*

</aside>

1. SYN 단계

   1. 클라이언트는 서버에 클라이언트에 ISN을 담아 SYN을 보낸다.

      _(ISN은 새로운 TCP연결의 첫 번째 패킷에 할당된 임의의 시퀀스 번호를 말한다.)_

2. SYN + ACK 단계
   1. 서버는 클라이언트의 SYN을 수신하고 서버의 ISN을 보내며, 승인번호로 클라이언트의 ISN + 1을 보낸다.
3. ACK 단계
   1. 클라이언트는 서버의 ISN + 1한 값인 승인번호를 담아서 ACK를 서버에 보낸다.

_(TCP는 이러한 과정이 있기에 신뢰성이 있다고 한다. UDP는 이 과정이 없어서 신뢰 X)_

**4-way handshake**

TCP는 연결을 해제할 때는 4-way handshake 과정이 발생한다.

![image.png](%E1%84%89%E1%85%AE%E1%84%8B%E1%85%A5%E1%86%B8%20%E1%84%82%E1%85%A2%E1%84%8B%E1%85%AD%E1%86%BC%201641a7d7f2f98028af07fb3c7b8be951/image%202.png)

<aside>

**TIME_WAIT**

소켓이 소멸되지 않고 일정 시간 유지되는 상태
→ 지연 패킷 등의 문제를 해결하는데 사용한다.

_(OS마다 조금씩 다르다.)_

</aside>

진행 과정

1. 클라이언트가 연결을 종료하려고 할 때 클라이언트는 FIN으로 설정된 세그먼트를 전송하고, FIN_WAIT_1 상태로 들어가서 서버의 응답을 기다린다.
2. 서버는 클라이언트로 ACK라는 승인 세그먼트를 전송한다. 그리고 CLOSE_WAIT 상태에 들어간다.

   → 클라이언트는 세그먼트를 받으면 FIN_WAIT_2 상태로 들어간다.

3. 서버는 ACK를 보내고 일정 시간 이후에 클라이언트에 FIN이라는 세그먼트를 전송한다.
4. 클라이언트는 TIME_WAIT상태가 되고 다시 서버로 ACK를 보내서 서버는 CLOSED 상태가 되고 클라이언트는 일정 시간 대기 후 연결이 닫히고 모든 연결이 해제된다.

- 연결을 굳이 일정 시간 이후에 닫는 이유

  1. 지연 패킷을 대비하기 위해

     → 패킷이 뒤늦게 도달하고 이를 처리하지 못하면 데이터 무결성 문제가 발생합니다

  2. 두 장치가 연결이 닫혔는지 확인하기 위해

     → LAST ACK에서 닫히게 되면 다시 새로운 연결을 할 때 장치는 LAST ACK로 되어 있기 때문에 접속 오류가 발생한다.

### UDP

순서를 보장하지 않고, 수신 여부를 확인하지 않으며 단순히 데이터만 주고 받는 ‘데이터그램 패킷 교환 방식’을 사용한다.

**데이터그램 패킷 교환 방식**

패킷이 독립적으로 이동하며 최적의 경로를 선택하여 가는데, 하나의 메시지에서 분할된 여러 패킷은 서로 다른 경로로 전송될 수 있으며 도착한 순서가 다를 수 있는 방식

![34.png](%E1%84%89%E1%85%AE%E1%84%8B%E1%85%A5%E1%86%B8%20%E1%84%82%E1%85%A2%E1%84%8B%E1%85%AD%E1%86%BC%201641a7d7f2f98028af07fb3c7b8be951/34.png)

_(짧은 메시지의 일시적인 전송에 적합하고, 네트워크 내의 한 노드가 다운되어도 다른 경로를 새로 설정한다.)_

---

### 인터넷 계층

인터넷 계층은 장치로부터 받은 네트워크 패킷을 IP 주소로 지정된 목적지로 전송하기 위해 사용되는 계층이다.

IP, ARP, ICMP 등이 있으며 패킷을 수신해야 할 상대의 주소를 지정하여 데이터를 전달한다.

→ 그러나 상대방이 제대로 받았는지에 대해서는 보장하지 않는 비연결형적인 특징을 가진다.

---

### 링크 계층

링크 계층은 전송, 광섬유, 무선 등으로 실질적으로 데이터를 전달하며 장치 간에 신호를 주고받는 규칙을 정하는 계층이다. _(네트워크 접근 계층이라고도 한다.)_

물리 계층과 데이터 링크 계층으로도 나누기도 한다. _(→ 7계층에선)_

(링크 계층에 대해서는 물리 계층과 데이터 링크를 나눠서 보는 것이 편해보여서 나눠서 다루겠습니다.)

### 물리 계층

물리 계층에서는 유선 LAN과 무선 LAN을 통해 0과 1로 이루어진 데이터를 보내는 계층이다.

**유선 LAN**

유선 LAN을 이루는 이더넷은 IEEE802.3이라는 프로토콜을 따르며 전이중화 통신을 사용한다.

케이블

대표적으로 TP 케이블이라고 하는 트위스트 페어 케이블과 광섬유 케이블이 대표적이다.

1. 트위스트 페어 케이블

   여덟개의 구리선을 두 개씩 꼬아서 묶은 케이블

   _(실드 처리 유무에 따라 STP와 UTP로 구분된다. [ex) LAN 케이블])_

2. 광섬유 케이블

   광섬유로 만든 케이블

   ![image.png](%E1%84%89%E1%85%AE%E1%84%8B%E1%85%A5%E1%86%B8%20%E1%84%82%E1%85%A2%E1%84%8B%E1%85%AD%E1%86%BC%201641a7d7f2f98028af07fb3c7b8be951/image%203.png)

   - 레이저로 통신하기 때문에 장거리 및 고속 통신이 가능
   - 100Gbps의 데이터를 전송
   - 내부와 외부를 다른 밀도를 가지는 유리나 플라스틱 섬유로 제작하여 한 번 들어간 빛이 내부에서 계속 반사되며 전진하여 끝까지 도달하는 원리

   _(빛의 굴절률이 높은 부분을 코어라고 하며 낮은 부분을 클래딩이라고 한다.)_

전이중화 통신

![image.png](%E1%84%89%E1%85%AE%E1%84%8B%E1%85%A5%E1%86%B8%20%E1%84%82%E1%85%A2%E1%84%8B%E1%85%AD%E1%86%BC%201641a7d7f2f98028af07fb3c7b8be951/image%204.png)

양쪽 장치가 동시에 송수신 할 수 있는 방식이다.

→ 송신로와 수신로로 나눠서 데이터를 주고 받는다. _(현대 고속 이더넷이 이 방식을 기반으로 통신)_

- CSMA/CD
  이전에는 유선 LAN에 반이중화 통신 중 하나인 CSMA/CD 방식을 사용했다.
  > 데이터를 보낸 이후 충돌이 생기면, 일정 시간 이후 재전송하는 방식
  > → 송신로와 수신로가 한개의 경로로 공유를 하기 때문에 충돌에 대한 대비를 한 것

**무선 LAN (IEEE802.11)**

무선 LAN 장치는 수신과 송신에 같은 채널을 사용하기 때문에 반이중화 통신을 사용한다.

반이중화 통신

![image.png](%E1%84%89%E1%85%AE%E1%84%8B%E1%85%A5%E1%86%B8%20%E1%84%82%E1%85%A2%E1%84%8B%E1%85%AD%E1%86%BC%201641a7d7f2f98028af07fb3c7b8be951/image%205.png)

양쪽 장치가 서로 통신할 순 있지만 동시에는 할 수 없으며, 한 번에 한 방향만 통신할 수 있는 방식이다.

_(동시에 전송하지 못하도록 충돌 방지 시스템이 필요하다.)_

- CSMA/CA
  반이중화 통신 중 하나로 장치에서 데이터를 보내기 전에 사전에 가능한 충돌을 방지하는 방식이다.
  1. 사용중인 채널이 있으면 다른 채널을 감지해서 유휴 상태인 채널을 발견한다.
     _(유휴 상태 : **컴퓨터나 프로그램이 실행 중이지만 작업이나 데이터를 적극적으로 처리하지 않는 상태**)_
  2. 프레임 간 공간 시간인 IFS 시간만큼 기다린다.
     _(IFS : 프레임의 우선순위를 정의할 때 사용 / 낮을 수록 우선순위가 높음)_
  3. 프레임을 랜덤 상수(0 ~ 2^k - 1 사이에서)를 기반으로 결정된 시간만큼 기다린 뒤, 프레임을 보낸다. ACK를 받으면 종료하고, 받지 못했다면 k = k + 1을 하며 과정을 반복한다. kmax보다 k가 커지면 해당 프레임은 버린다.
     이와 반대되는 전이중화 통신은 양방향 통신이 가능하므로 충돌 가능성이 없기 때문에 충돌을 방지하는 매커니즘이 필요가 없다.

무선 LAN을 이루는 주파수 : 2.4GHz / 5GHz

(2.4GHz는 장애물에 강하지만 전자레인지나 무선 등의 전파 간섭이 생기는 경우가 있기에 보통은 채널 수도 많고 동시에 사용할 수 있는 5GHz를 사용하는 것이 좋음)

**와이파이**

전자기기들이 무선 LAN 신호에 연결할 수 있게 하는 기술

- 무선 접속 장치 (AP)가 있어야 한다. → 흔히 공유기라고 함
- 유선 LAN에 흐르는 신호를 무선 LAN 신호로 바꿔준다.
- 와이파이, 지그비, 블루투스 등이 있다.

![image.png](%E1%84%89%E1%85%AE%E1%84%8B%E1%85%A5%E1%86%B8%20%E1%84%82%E1%85%A2%E1%84%8B%E1%85%AD%E1%86%BC%201641a7d7f2f98028af07fb3c7b8be951/c8fc18a5-0bb0-44bf-ac01-d5a026d9e908.png)

**BSS**

기본 서비스 집합을 의미하며 단순 공유기를 통해 네트워크에 접속하는 것이 아닌, 동일 BSS 내에 있는 AP들과 장치들이 서로 통신이 가능한 구조를 말한다.

- 근거리 무선 통신을 제공한다.
- 하나의 AP만을 기반으로 구축된다.
  - 사용자는 한 장소에서 다른 장소로 이동하며 네트워크에 접속하는 것은 불가하다.

**ESS**

하나 이상의 연결된 BSS 그룹이다.

- 장거리 무선 통신을 제공한다
- BSS보다 더 많은 가용성과 이동성을 지원한다.
  - 사용자는 한 장소에서 다른 장소로 이동하며 중단없이 네트워크를 연결할 수 있다.

### 데이터 링크 계층

데이터 링크 계층은 이더넷 프레임을 통해 에러 확인, 흐름 제어, 접근 제어를 담당하는 계층이다.

![image.png](%E1%84%89%E1%85%AE%E1%84%8B%E1%85%A5%E1%86%B8%20%E1%84%82%E1%85%A2%E1%84%8B%E1%85%AD%E1%86%BC%201641a7d7f2f98028af07fb3c7b8be951/68fb347c-abbb-4479-b15b-56b035953499.png)

- preamble : 이더넷 프레임이 시작함을 알림
- SFD(Start Frame Delimiter) : 다음 바이트부터 MAC 주소 필드가 시작됨을 알림
- DMAC, SMAC : 수신, 송신 MAC 주소를 말한다.
- EtherType : 데이터 계층 위의 계층인 IP 프로토콜을 정의한다. (ex) IPv4, IPv6)
- Payload : 전달받은 데이터
- CRC : 에러 확인 비트

<aside>

**MAC 주소**

컴퓨터나 노트북 등 각 장치에는 LAN 카드 (네트워크에 연결하기 위한 장치)가 있는데, 이를 구별하기 위한 식별번호를 말한다. 6바이트(48비트)로 구성된다.

</aside>

**계층 간 데이터 송수신 과정**

![image.png](%E1%84%89%E1%85%AE%E1%84%8B%E1%85%A5%E1%86%B8%20%E1%84%82%E1%85%A2%E1%84%8B%E1%85%AD%E1%86%BC%201641a7d7f2f98028af07fb3c7b8be951/image%206.png)

캡슐화 과정을 거쳐서 전달을 하고 비캡슐화 과정을 거쳐 전송이 된다.

**캡슐화**

![image.png](%E1%84%89%E1%85%AE%E1%84%8B%E1%85%A5%E1%86%B8%20%E1%84%82%E1%85%A2%E1%84%8B%E1%85%AD%E1%86%BC%201641a7d7f2f98028af07fb3c7b8be951/image%207.png)

상위 계층의 헤더와 데이터를 하위 계층의 데이터 부분에 포함시키고 해당 계층의 헤더를 삽입하는 과정

> 메시지 → 세그먼트화(데이터그램화) L4 → 패킷화 L3 → 프레임화

**비캡슐화**

![image.png](%E1%84%89%E1%85%AE%E1%84%8B%E1%85%A5%E1%86%B8%20%E1%84%82%E1%85%A2%E1%84%8B%E1%85%AD%E1%86%BC%201641a7d7f2f98028af07fb3c7b8be951/image%208.png)

하위 계층에서 상위 계층으로 가며 각 계층의 헤더 부분을 제거하는 과정

> 프레임화 → 패킷화 → 세그먼트화(데이터그램화) → 메시지화

### **TIL**

---

<aside>
💡

아직 말이 많이 어렵다~

</aside>
